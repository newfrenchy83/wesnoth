#textdomain wesnoth-test

#define TEST_GIVE_LEADERSHIP ID AMOUNT CUMULATIVE
    [object]
        [filter]
            id={ID}
        [/filter]
        [effect]
            apply_to=new_ability
            [abilities]
                [leadership]
                    id="leadership_from_{ID}"
                    cumulative={CUMULATIVE}
                    value={AMOUNT}
#ifndef SCHEMA_VALIDATION
                        name="leadership_from_{ID}"
#endif
                    affect_self=yes
                    affect_allies=yes
                    affect_enemies=yes
                    [affect_adjacent]
                    [/affect_adjacent]
                [/leadership]
            [/abilities]
        [/effect]
    [/object]
#enddef

#####
# API(s) being tested: [leadership]cumulative,value=yes,{SOME_NUMBER}
##
# Actions:
# Alice is adjacent to everyone, and so is Bob. No sides are allied.
# Charlie has a cumulative leadership skill, which buffs enemy units.
# Dave has a non-cumulative leadership skill, which buffs enemy units.
#
# There's another variant which reverses which of Charlie and Dave have
# the cumulative skill.
##
# Expected end state:
# A workbench for manually checking the that the stats are the same
#####
{COMMON_KEEP_A_B_C_D_UNIT_TEST cumulative_leadership_charlie (
    [event]
        name=start

        {TEST_GIVE_LEADERSHIP bob 50 yes}
        {TEST_GIVE_LEADERSHIP charlie 50 yes}
        {TEST_GIVE_LEADERSHIP dave 50 no}
    [/event]
)}

{COMMON_KEEP_A_B_C_D_UNIT_TEST cumulative_leadership_dave (
    [event]
        name=start

        {TEST_GIVE_LEADERSHIP bob 50 yes}
        {TEST_GIVE_LEADERSHIP charlie 50 no}
        {TEST_GIVE_LEADERSHIP dave 50 yes}
    [/event]
)}

{COMMON_KEEP_A_B_C_D_UNIT_TEST cumulative_leadership_both (
    [event]
        name=start

        {TEST_GIVE_LEADERSHIP bob 50 yes}
        {TEST_GIVE_LEADERSHIP charlie 50 yes}
        {TEST_GIVE_LEADERSHIP dave 50 yes}
    [/event]
)}

{COMMON_KEEP_A_B_C_D_UNIT_TEST cumulative_leadership_neither (
    [event]
        name=start

        {TEST_GIVE_LEADERSHIP bob 50 yes}
        {TEST_GIVE_LEADERSHIP charlie 50 no}
        {TEST_GIVE_LEADERSHIP dave 50 no}
    [/event]
)}
